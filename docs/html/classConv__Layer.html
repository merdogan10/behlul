<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BEHLUL: Conv_Layer Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BEHLUL
   &#160;<span id="projectnumber">0.9</span>
   </div>
   <div id="projectbrief">Behlul is an Efficient High Level Useful Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="classConv__Layer-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Conv_Layer Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Convolutional Layer.  
 <a href="classConv__Layer.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>&gt;</code></p>
<div class="dynheader">
Collaboration diagram for Conv_Layer:</div>
<div class="dyncontent">
<div class="center"><img src="classConv__Layer__coll__graph.png" border="0" usemap="#Conv__Layer_coll__map" alt="Collaboration graph"/></div>
<!-- MAP 0 -->
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a919a1eac6f6f47f93b91a273ea612db0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a919a1eac6f6f47f93b91a273ea612db0">Conv_Layer</a> (int <a class="el" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a>, int <a class="el" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a>, int <a class="el" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>, int <a class="el" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, int <a class="el" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, int <a class="el" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>)</td></tr>
<tr class="memdesc:a919a1eac6f6f47f93b91a273ea612db0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a <a class="el" href="classConv__Layer.html" title="Convolutional Layer.">Conv_Layer</a>.  <a href="#a919a1eac6f6f47f93b91a273ea612db0">More...</a><br /></td></tr>
<tr class="separator:a919a1eac6f6f47f93b91a273ea612db0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a182743caee949ef04477d43a2f638955"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a182743caee949ef04477d43a2f638955">set_input</a> (vector&lt; MatrixXd &gt; <a class="el" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>)</td></tr>
<tr class="memdesc:a182743caee949ef04477d43a2f638955"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set input.  <a href="#a182743caee949ef04477d43a2f638955">More...</a><br /></td></tr>
<tr class="separator:a182743caee949ef04477d43a2f638955"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0978882f2069185a5879a363f35288ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a0978882f2069185a5879a363f35288ea">clear_output</a> ()</td></tr>
<tr class="memdesc:a0978882f2069185a5879a363f35288ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">Clear output.  <a href="#a0978882f2069185a5879a363f35288ea">More...</a><br /></td></tr>
<tr class="separator:a0978882f2069185a5879a363f35288ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a890e82fe22c8acf748934aa0c4a021b6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a890e82fe22c8acf748934aa0c4a021b6">feed_forward</a> (vector&lt; MatrixXd &gt; <a class="el" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>)</td></tr>
<tr class="memdesc:a890e82fe22c8acf748934aa0c4a021b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Forward pass of the Convolutional Layer.  <a href="#a890e82fe22c8acf748934aa0c4a021b6">More...</a><br /></td></tr>
<tr class="separator:a890e82fe22c8acf748934aa0c4a021b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c805ad7807bb1a93cab80ec93ecb198"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a4c805ad7807bb1a93cab80ec93ecb198">back_propagation</a> (vector&lt; MatrixXd &gt; upstream_gradient)</td></tr>
<tr class="memdesc:a4c805ad7807bb1a93cab80ec93ecb198"><td class="mdescLeft">&#160;</td><td class="mdescRight">Backward pass of the Convolutional Layer.  <a href="#a4c805ad7807bb1a93cab80ec93ecb198">More...</a><br /></td></tr>
<tr class="separator:a4c805ad7807bb1a93cab80ec93ecb198"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa481ae18f7b79a6b1bca9beb434807d6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#aa481ae18f7b79a6b1bca9beb434807d6">update_weights</a> (int batch_size, double learning_rate)</td></tr>
<tr class="memdesc:aa481ae18f7b79a6b1bca9beb434807d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update filters of the Convolutional Layer.  <a href="#aa481ae18f7b79a6b1bca9beb434807d6">More...</a><br /></td></tr>
<tr class="separator:aa481ae18f7b79a6b1bca9beb434807d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71b6d1c2742e76d79baf6b653ee289ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a71b6d1c2742e76d79baf6b653ee289ca">save_filters</a> (string dir)</td></tr>
<tr class="memdesc:a71b6d1c2742e76d79baf6b653ee289ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Save filters to local file.  <a href="#a71b6d1c2742e76d79baf6b653ee289ca">More...</a><br /></td></tr>
<tr class="separator:a71b6d1c2742e76d79baf6b653ee289ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1184ef4a42762dcfdabe5c6cf5aa3fc2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a1184ef4a42762dcfdabe5c6cf5aa3fc2">load_filters</a> (string dir)</td></tr>
<tr class="memdesc:a1184ef4a42762dcfdabe5c6cf5aa3fc2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load filters from local file.  <a href="#a1184ef4a42762dcfdabe5c6cf5aa3fc2">More...</a><br /></td></tr>
<tr class="separator:a1184ef4a42762dcfdabe5c6cf5aa3fc2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a8fa49a2055afbb56bd2b1e456e8a217f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a></td></tr>
<tr class="memdesc:a8fa49a2055afbb56bd2b1e456e8a217f"><td class="mdescLeft">&#160;</td><td class="mdescRight">height of the input  <a href="#a8fa49a2055afbb56bd2b1e456e8a217f">More...</a><br /></td></tr>
<tr class="separator:a8fa49a2055afbb56bd2b1e456e8a217f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a258888ab5dd029b67af9beca192fcb"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a></td></tr>
<tr class="memdesc:a5a258888ab5dd029b67af9beca192fcb"><td class="mdescLeft">&#160;</td><td class="mdescRight">width of the input  <a href="#a5a258888ab5dd029b67af9beca192fcb">More...</a><br /></td></tr>
<tr class="separator:a5a258888ab5dd029b67af9beca192fcb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89b83cf9926dd0779c5ebbca93755820"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a></td></tr>
<tr class="memdesc:a89b83cf9926dd0779c5ebbca93755820"><td class="mdescLeft">&#160;</td><td class="mdescRight">depth of the input  <a href="#a89b83cf9926dd0779c5ebbca93755820">More...</a><br /></td></tr>
<tr class="separator:a89b83cf9926dd0779c5ebbca93755820"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1701b3320641cd2514509032da75c024"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a> = 3</td></tr>
<tr class="memdesc:a1701b3320641cd2514509032da75c024"><td class="mdescLeft">&#160;</td><td class="mdescRight">height and width of the square filter  <a href="#a1701b3320641cd2514509032da75c024">More...</a><br /></td></tr>
<tr class="separator:a1701b3320641cd2514509032da75c024"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> = 1</td></tr>
<tr class="memdesc:a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><td class="mdescLeft">&#160;</td><td class="mdescRight">stride of the filter  <a href="#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">More...</a><br /></td></tr>
<tr class="separator:a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3337c86c1aba37a9c3d9158d6af5e915"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a> = 1</td></tr>
<tr class="memdesc:a3337c86c1aba37a9c3d9158d6af5e915"><td class="mdescLeft">&#160;</td><td class="mdescRight">number of filters  <a href="#a3337c86c1aba37a9c3d9158d6af5e915">More...</a><br /></td></tr>
<tr class="separator:a3337c86c1aba37a9c3d9158d6af5e915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c1e8b24b977813e39633e73588cc90e"><td class="memItemLeft" align="right" valign="top">vector&lt; MatrixXd &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a></td></tr>
<tr class="memdesc:a0c1e8b24b977813e39633e73588cc90e"><td class="mdescLeft">&#160;</td><td class="mdescRight">input of the layer  <a href="#a0c1e8b24b977813e39633e73588cc90e">More...</a><br /></td></tr>
<tr class="separator:a0c1e8b24b977813e39633e73588cc90e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d87494c9f1c7baff061591899be968a"><td class="memItemLeft" align="right" valign="top">vector&lt; MatrixXd &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a></td></tr>
<tr class="memdesc:a8d87494c9f1c7baff061591899be968a"><td class="mdescLeft">&#160;</td><td class="mdescRight">output of the layer  <a href="#a8d87494c9f1c7baff061591899be968a">More...</a><br /></td></tr>
<tr class="separator:a8d87494c9f1c7baff061591899be968a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a0080d32bf49e3cfe0fa01f3010c106"><td class="memItemLeft" align="right" valign="top">vector&lt; MatrixXd &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">gradients</a></td></tr>
<tr class="memdesc:a2a0080d32bf49e3cfe0fa01f3010c106"><td class="mdescLeft">&#160;</td><td class="mdescRight">gradients of the layer  <a href="#a2a0080d32bf49e3cfe0fa01f3010c106">More...</a><br /></td></tr>
<tr class="separator:a2a0080d32bf49e3cfe0fa01f3010c106"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaae2d2d7e2197812d9670877a2a85aeb"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; MatrixXd &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a></td></tr>
<tr class="memdesc:aaae2d2d7e2197812d9670877a2a85aeb"><td class="mdescLeft">&#160;</td><td class="mdescRight">filters of the layer  <a href="#aaae2d2d7e2197812d9670877a2a85aeb">More...</a><br /></td></tr>
<tr class="separator:aaae2d2d7e2197812d9670877a2a85aeb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22036e23bad935dbbd9ea32bae3b8a6c"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; MatrixXd &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a></td></tr>
<tr class="memdesc:a22036e23bad935dbbd9ea32bae3b8a6c"><td class="mdescLeft">&#160;</td><td class="mdescRight">gradients of the filters  <a href="#a22036e23bad935dbbd9ea32bae3b8a6c">More...</a><br /></td></tr>
<tr class="separator:a22036e23bad935dbbd9ea32bae3b8a6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b147b25daaba5dff457157a0856d094"><td class="memItemLeft" align="right" valign="top">vector&lt; vector&lt; MatrixXd &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a></td></tr>
<tr class="memdesc:a7b147b25daaba5dff457157a0856d094"><td class="mdescLeft">&#160;</td><td class="mdescRight">accumulated gradients of the filters  <a href="#a7b147b25daaba5dff457157a0856d094">More...</a><br /></td></tr>
<tr class="separator:a7b147b25daaba5dff457157a0856d094"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Convolutional Layer. </p>
<p>This class is used as Convolutional Layer of a neural network. It gets details of its input and filter initially.</p>
<dl class="section author"><dt>Author</dt><dd></dd></dl>
<dl class="section rcs"><dt>Author</dt><dd>Mustafa Erdogan </dd></dl>
<dl class="section version"><dt>Version</dt><dd></dd></dl>
<dl class="section rcs"><dt>Revision</dt><dd>0.87 </dd></dl>
<dl class="section date"><dt>Date</dt><dd></dd></dl>
<dl class="section rcs"><dt>Date</dt><dd>24/07/2019 14:16:20 </dd></dl>
<p>Contact: <a href="#" onclick="location.href='mai'+'lto:'+'mus'+'ta'+'fa.'+'er'+'dog'+'an'+'@tu'+'m.'+'de'; return false;">musta<span style="display: none;">.nosp@m.</span>fa.e<span style="display: none;">.nosp@m.</span>rdoga<span style="display: none;">.nosp@m.</span>n@tu<span style="display: none;">.nosp@m.</span>m.de</a> </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00034">34</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a919a1eac6f6f47f93b91a273ea612db0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a919a1eac6f6f47f93b91a273ea612db0">&#9670;&nbsp;</a></span>Conv_Layer()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Conv_Layer::Conv_Layer </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>height</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>depth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>filter_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>stride</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>num_filters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create a <a class="el" href="classConv__Layer.html" title="Convolutional Layer.">Conv_Layer</a>. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">height</td><td>height of the input </td></tr>
    <tr><td class="paramname">width</td><td>width of the input </td></tr>
    <tr><td class="paramname">depth</td><td>depth of the input </td></tr>
    <tr><td class="paramname">filter_size</td><td>height and width of the square filter </td></tr>
    <tr><td class="paramname">stride</td><td>stride of the filter </td></tr>
    <tr><td class="paramname">num_filters</td><td>number of filters</td></tr>
  </table>
  </dd>
</dl>
<p>This method creates a Convolutional Layer. Initializes given values. Initializes filters with uniform random values. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00003">3</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;                                                    {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a> = <a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a>;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a> = <a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a>;</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a> = <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a> = <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>;</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> = <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>;</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a> = <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>;</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;  <a class="code" href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">gradients</a>.resize(this-&gt;<a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>);</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;  <a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>.resize(this-&gt;<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>);</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; i++) {</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; this-&gt;<a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; j++) {</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;      <a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[i].push_back(MatrixXd::Random(<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>));</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;    }</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;  }</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;  <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>.resize(<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>);</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++)</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++)</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;      <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>[f].push_back(</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;          MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>));</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_a7b147b25daaba5dff457157a0856d094"><div class="ttname"><a href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">Conv_Layer::accumulated_gradient_filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; accumulated_gradient_filters</div><div class="ttdoc">accumulated gradients of the filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00063">conv_layer.hpp:63</a></div></div>
<div class="ttc" id="classConv__Layer_html_a3337c86c1aba37a9c3d9158d6af5e915"><div class="ttname"><a href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">Conv_Layer::num_filters</a></div><div class="ttdeci">int num_filters</div><div class="ttdoc">number of filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00055">conv_layer.hpp:55</a></div></div>
<div class="ttc" id="classConv__Layer_html_a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><div class="ttname"><a href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">Conv_Layer::stride</a></div><div class="ttdeci">int stride</div><div class="ttdoc">stride of the filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00054">conv_layer.hpp:54</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8fa49a2055afbb56bd2b1e456e8a217f"><div class="ttname"><a href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">Conv_Layer::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">height of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00050">conv_layer.hpp:50</a></div></div>
<div class="ttc" id="classConv__Layer_html_a5a258888ab5dd029b67af9beca192fcb"><div class="ttname"><a href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">Conv_Layer::width</a></div><div class="ttdeci">int width</div><div class="ttdoc">width of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00051">conv_layer.hpp:51</a></div></div>
<div class="ttc" id="classConv__Layer_html_a89b83cf9926dd0779c5ebbca93755820"><div class="ttname"><a href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">Conv_Layer::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">depth of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00052">conv_layer.hpp:52</a></div></div>
<div class="ttc" id="classConv__Layer_html_a1701b3320641cd2514509032da75c024"><div class="ttname"><a href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">Conv_Layer::filter_size</a></div><div class="ttdeci">int filter_size</div><div class="ttdoc">height and width of the square filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00053">conv_layer.hpp:53</a></div></div>
<div class="ttc" id="classConv__Layer_html_a2a0080d32bf49e3cfe0fa01f3010c106"><div class="ttname"><a href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">Conv_Layer::gradients</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; gradients</div><div class="ttdoc">gradients of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00059">conv_layer.hpp:59</a></div></div>
<div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a4c805ad7807bb1a93cab80ec93ecb198"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c805ad7807bb1a93cab80ec93ecb198">&#9670;&nbsp;</a></span>back_propagation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::back_propagation </td>
          <td>(</td>
          <td class="paramtype">vector&lt; MatrixXd &gt;&#160;</td>
          <td class="paramname"><em>upstream_gradient</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Backward pass of the Convolutional Layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">upstream_gradient</td><td>gradients coming from the next layer</td></tr>
  </table>
  </dd>
</dl>
<p>This function iterates backward pass of the Convolutional Layer. As input it gets the next layer's gradients. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00063">63</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;                                                                    {</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++) {</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <a class="code" href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">gradients</a>[d] = MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a>, <a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a>);</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;  }</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>[f].rows(); r++) {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>[f].cols(); c++) {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++) {</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;          MatrixXd tmp = MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a>, <a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a>);</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;          tmp.block(r * <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, c * <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>) =</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;              <a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d];</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;          <a class="code" href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">gradients</a>[d] += upstream_gradient[f](r, c) * tmp;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      }</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  }</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>.clear();</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>.resize(<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; i++) {</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>[i].resize(<a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>);</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; j++) {</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>[i][j] = MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>);</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    }</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  }</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++) {</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r = 0; r &lt; <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>[f].rows(); r++) {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c = 0; c &lt; <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>[f].cols(); c++) {</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++) {</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;          MatrixXd tmp = MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;          tmp =</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;              <a class="code" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>[d].block(r * <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, c * <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;          <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>[f][d] += upstream_gradient[f](r, c) * tmp;</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        }</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      }</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++)</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++)</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;      <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>[f][d] += <a class="code" href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">gradient_filters</a>[f][d];</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_a0c1e8b24b977813e39633e73588cc90e"><div class="ttname"><a href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">Conv_Layer::input</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; input</div><div class="ttdoc">input of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00057">conv_layer.hpp:57</a></div></div>
<div class="ttc" id="classConv__Layer_html_a7b147b25daaba5dff457157a0856d094"><div class="ttname"><a href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">Conv_Layer::accumulated_gradient_filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; accumulated_gradient_filters</div><div class="ttdoc">accumulated gradients of the filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00063">conv_layer.hpp:63</a></div></div>
<div class="ttc" id="classConv__Layer_html_a3337c86c1aba37a9c3d9158d6af5e915"><div class="ttname"><a href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">Conv_Layer::num_filters</a></div><div class="ttdeci">int num_filters</div><div class="ttdoc">number of filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00055">conv_layer.hpp:55</a></div></div>
<div class="ttc" id="classConv__Layer_html_a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><div class="ttname"><a href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">Conv_Layer::stride</a></div><div class="ttdeci">int stride</div><div class="ttdoc">stride of the filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00054">conv_layer.hpp:54</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8d87494c9f1c7baff061591899be968a"><div class="ttname"><a href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">Conv_Layer::output</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; output</div><div class="ttdoc">output of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00058">conv_layer.hpp:58</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8fa49a2055afbb56bd2b1e456e8a217f"><div class="ttname"><a href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">Conv_Layer::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">height of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00050">conv_layer.hpp:50</a></div></div>
<div class="ttc" id="classConv__Layer_html_a5a258888ab5dd029b67af9beca192fcb"><div class="ttname"><a href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">Conv_Layer::width</a></div><div class="ttdeci">int width</div><div class="ttdoc">width of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00051">conv_layer.hpp:51</a></div></div>
<div class="ttc" id="classConv__Layer_html_a22036e23bad935dbbd9ea32bae3b8a6c"><div class="ttname"><a href="classConv__Layer.html#a22036e23bad935dbbd9ea32bae3b8a6c">Conv_Layer::gradient_filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; gradient_filters</div><div class="ttdoc">gradients of the filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00061">conv_layer.hpp:61</a></div></div>
<div class="ttc" id="classConv__Layer_html_a89b83cf9926dd0779c5ebbca93755820"><div class="ttname"><a href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">Conv_Layer::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">depth of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00052">conv_layer.hpp:52</a></div></div>
<div class="ttc" id="classConv__Layer_html_a1701b3320641cd2514509032da75c024"><div class="ttname"><a href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">Conv_Layer::filter_size</a></div><div class="ttdeci">int filter_size</div><div class="ttdoc">height and width of the square filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00053">conv_layer.hpp:53</a></div></div>
<div class="ttc" id="classConv__Layer_html_a2a0080d32bf49e3cfe0fa01f3010c106"><div class="ttname"><a href="classConv__Layer.html#a2a0080d32bf49e3cfe0fa01f3010c106">Conv_Layer::gradients</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; gradients</div><div class="ttdoc">gradients of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00059">conv_layer.hpp:59</a></div></div>
<div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0978882f2069185a5879a363f35288ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0978882f2069185a5879a363f35288ea">&#9670;&nbsp;</a></span>clear_output()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::clear_output </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Clear output. </p>
<p>This method clears output of the Convolutional Layer and fills with zeros. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00030">30</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;                              {</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;  <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>.clear();</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; i++) {</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;    <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>.push_back(MatrixXd::Zero((<a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>) / <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> + 1,</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                    (<a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>) / <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> + 1));</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  }</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_a3337c86c1aba37a9c3d9158d6af5e915"><div class="ttname"><a href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">Conv_Layer::num_filters</a></div><div class="ttdeci">int num_filters</div><div class="ttdoc">number of filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00055">conv_layer.hpp:55</a></div></div>
<div class="ttc" id="classConv__Layer_html_a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><div class="ttname"><a href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">Conv_Layer::stride</a></div><div class="ttdeci">int stride</div><div class="ttdoc">stride of the filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00054">conv_layer.hpp:54</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8d87494c9f1c7baff061591899be968a"><div class="ttname"><a href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">Conv_Layer::output</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; output</div><div class="ttdoc">output of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00058">conv_layer.hpp:58</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8fa49a2055afbb56bd2b1e456e8a217f"><div class="ttname"><a href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">Conv_Layer::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">height of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00050">conv_layer.hpp:50</a></div></div>
<div class="ttc" id="classConv__Layer_html_a5a258888ab5dd029b67af9beca192fcb"><div class="ttname"><a href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">Conv_Layer::width</a></div><div class="ttdeci">int width</div><div class="ttdoc">width of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00051">conv_layer.hpp:51</a></div></div>
<div class="ttc" id="classConv__Layer_html_a1701b3320641cd2514509032da75c024"><div class="ttname"><a href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">Conv_Layer::filter_size</a></div><div class="ttdeci">int filter_size</div><div class="ttdoc">height and width of the square filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00053">conv_layer.hpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a890e82fe22c8acf748934aa0c4a021b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a890e82fe22c8acf748934aa0c4a021b6">&#9670;&nbsp;</a></span>feed_forward()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::feed_forward </td>
          <td>(</td>
          <td class="paramtype">vector&lt; MatrixXd &gt;&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Forward pass of the Convolutional Layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>input of the Convolutional Layer</td></tr>
  </table>
  </dd>
</dl>
<p>This function iterates forward pass of the Convolutional Layer. As input it gets the previous layer's output in middle layers or image in starting layer. The output filled is used later from the next layer. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00038">38</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;                                                    {</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>) % <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> != 0) {</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Filter dimension and stride is not valid height&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;  }</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  <span class="keywordflow">if</span> ((<a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>) % <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a> != 0) {</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    cout &lt;&lt; <span class="stringliteral">&quot;Filter dimension and stride is not valid for width&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  }</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a182743caee949ef04477d43a2f638955">set_input</a>(<a class="code" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>);</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#a0978882f2069185a5879a363f35288ea">clear_output</a>();</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++) {</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0, r = 0; i &lt; <a class="code" href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">height</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a> + 1; i += <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, r++) {</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0, c = 0; j &lt; <a class="code" href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">width</a> - <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a> + 1; j += <a class="code" href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">stride</a>, c++) {</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++) {</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;          MatrixXd sub_matrix = <a class="code" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>[d].block(i, j, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>);</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;          <a class="code" href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">output</a>[f](r, c) += <a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d].cwiseProduct(sub_matrix).sum();</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        }</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    }</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;  }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_a0c1e8b24b977813e39633e73588cc90e"><div class="ttname"><a href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">Conv_Layer::input</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; input</div><div class="ttdoc">input of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00057">conv_layer.hpp:57</a></div></div>
<div class="ttc" id="classConv__Layer_html_a3337c86c1aba37a9c3d9158d6af5e915"><div class="ttname"><a href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">Conv_Layer::num_filters</a></div><div class="ttdeci">int num_filters</div><div class="ttdoc">number of filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00055">conv_layer.hpp:55</a></div></div>
<div class="ttc" id="classConv__Layer_html_a7cd15d6b15a9a4b9e0aabdcadf5ad68c"><div class="ttname"><a href="classConv__Layer.html#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">Conv_Layer::stride</a></div><div class="ttdeci">int stride</div><div class="ttdoc">stride of the filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00054">conv_layer.hpp:54</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8d87494c9f1c7baff061591899be968a"><div class="ttname"><a href="classConv__Layer.html#a8d87494c9f1c7baff061591899be968a">Conv_Layer::output</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; output</div><div class="ttdoc">output of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00058">conv_layer.hpp:58</a></div></div>
<div class="ttc" id="classConv__Layer_html_a8fa49a2055afbb56bd2b1e456e8a217f"><div class="ttname"><a href="classConv__Layer.html#a8fa49a2055afbb56bd2b1e456e8a217f">Conv_Layer::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">height of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00050">conv_layer.hpp:50</a></div></div>
<div class="ttc" id="classConv__Layer_html_a5a258888ab5dd029b67af9beca192fcb"><div class="ttname"><a href="classConv__Layer.html#a5a258888ab5dd029b67af9beca192fcb">Conv_Layer::width</a></div><div class="ttdeci">int width</div><div class="ttdoc">width of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00051">conv_layer.hpp:51</a></div></div>
<div class="ttc" id="classConv__Layer_html_a182743caee949ef04477d43a2f638955"><div class="ttname"><a href="classConv__Layer.html#a182743caee949ef04477d43a2f638955">Conv_Layer::set_input</a></div><div class="ttdeci">void set_input(vector&lt; MatrixXd &gt; input)</div><div class="ttdoc">Set input.</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8cpp_source.html#l00028">conv_layer.cpp:28</a></div></div>
<div class="ttc" id="classConv__Layer_html_a89b83cf9926dd0779c5ebbca93755820"><div class="ttname"><a href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">Conv_Layer::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">depth of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00052">conv_layer.hpp:52</a></div></div>
<div class="ttc" id="classConv__Layer_html_a1701b3320641cd2514509032da75c024"><div class="ttname"><a href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">Conv_Layer::filter_size</a></div><div class="ttdeci">int filter_size</div><div class="ttdoc">height and width of the square filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00053">conv_layer.hpp:53</a></div></div>
<div class="ttc" id="classConv__Layer_html_a0978882f2069185a5879a363f35288ea"><div class="ttname"><a href="classConv__Layer.html#a0978882f2069185a5879a363f35288ea">Conv_Layer::clear_output</a></div><div class="ttdeci">void clear_output()</div><div class="ttdoc">Clear output.</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8cpp_source.html#l00030">conv_layer.cpp:30</a></div></div>
<div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="classConv__Layer_a890e82fe22c8acf748934aa0c4a021b6_cgraph.png" border="0" usemap="#classConv__Layer_a890e82fe22c8acf748934aa0c4a021b6_cgraph" alt=""/></div>
<!-- MAP 1 -->
</div>

</div>
</div>
<a id="a1184ef4a42762dcfdabe5c6cf5aa3fc2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1184ef4a42762dcfdabe5c6cf5aa3fc2">&#9670;&nbsp;</a></span>load_filters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::load_filters </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load filters from local file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>file path to load filters</td></tr>
  </table>
  </dd>
</dl>
<p>This function loads filters of the Convolutional Layer to use in pretrained demo. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00136">136</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                                                 {</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  ifstream fin(filters_file);</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;  <span class="keywordtype">int</span> num_filt, num_depth, num_row, num_col;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;  fin &gt;&gt; num_filt;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>.clear();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;  this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>.resize(num_filt);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; num_filt; f++) {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    fin &gt;&gt; num_depth;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f].resize(num_depth);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; num_depth; d++) {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;      fin &gt;&gt; num_row &gt;&gt; num_col;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;      MatrixXd temp_filter(num_row, num_col);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num_row; i++) {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; num_col; j++) {</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;          fin &gt;&gt; temp_filter(i, j);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      }</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;      this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d] = temp_filter;</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    }</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  }</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  fin.close();</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a71b6d1c2742e76d79baf6b653ee289ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71b6d1c2742e76d79baf6b653ee289ca">&#9670;&nbsp;</a></span>save_filters()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::save_filters </td>
          <td>(</td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>dir</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Save filters to local file. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">dir</td><td>file path to save filters</td></tr>
  </table>
  </dd>
</dl>
<p>This function saves filters of the Convolutional Layer to use later in pretrained demo. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00122">122</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                                                 {</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  ofstream fout(filters_file);</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  fout &lt;&lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>.size() &lt;&lt; endl;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>.size(); f++) {</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    fout &lt;&lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f].size() &lt;&lt; endl;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f].size(); d++) {</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      fout &lt;&lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d].rows() &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d].cols()</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;           &lt;&lt; endl;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      fout &lt;&lt; this-&gt;<a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d] &lt;&lt; endl;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  }</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;  fout.close();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a182743caee949ef04477d43a2f638955"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a182743caee949ef04477d43a2f638955">&#9670;&nbsp;</a></span>set_input()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::set_input </td>
          <td>(</td>
          <td class="paramtype">vector&lt; MatrixXd &gt;&#160;</td>
          <td class="paramname"><em>input</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set input. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">input</td><td>input of the Convolutional Layer</td></tr>
  </table>
  </dd>
</dl>
<p>This method sets input of the Convolutional Layer </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00028">28</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;{ this-&gt;<a class="code" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a> = <a class="code" href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">input</a>; }</div><div class="ttc" id="classConv__Layer_html_a0c1e8b24b977813e39633e73588cc90e"><div class="ttname"><a href="classConv__Layer.html#a0c1e8b24b977813e39633e73588cc90e">Conv_Layer::input</a></div><div class="ttdeci">vector&lt; MatrixXd &gt; input</div><div class="ttdoc">input of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00057">conv_layer.hpp:57</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa481ae18f7b79a6b1bca9beb434807d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa481ae18f7b79a6b1bca9beb434807d6">&#9670;&nbsp;</a></span>update_weights()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Conv_Layer::update_weights </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>learning_rate</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update filters of the Convolutional Layer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch_size</td><td>batch size </td></tr>
    <tr><td class="paramname">learning_rate</td><td>learning rate</td></tr>
  </table>
  </dd>
</dl>
<p>This function updates filters of the Convolutional Layer. </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8cpp_source.html#l00108">108</a> of file <a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                                                                    {</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++)</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;      <a class="code" href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">filters</a>[f][d] -=</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;          learning_rate * (<a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>[f][d] / batch_size);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;  <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>.clear();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>.resize(<a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; f &lt; <a class="code" href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">num_filters</a>; f++)</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">depth</a>; d++)</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">accumulated_gradient_filters</a>[f].push_back(</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;          MatrixXd::Zero(<a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>, <a class="code" href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">filter_size</a>));</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div><div class="ttc" id="classConv__Layer_html_a7b147b25daaba5dff457157a0856d094"><div class="ttname"><a href="classConv__Layer.html#a7b147b25daaba5dff457157a0856d094">Conv_Layer::accumulated_gradient_filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; accumulated_gradient_filters</div><div class="ttdoc">accumulated gradients of the filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00063">conv_layer.hpp:63</a></div></div>
<div class="ttc" id="classConv__Layer_html_a3337c86c1aba37a9c3d9158d6af5e915"><div class="ttname"><a href="classConv__Layer.html#a3337c86c1aba37a9c3d9158d6af5e915">Conv_Layer::num_filters</a></div><div class="ttdeci">int num_filters</div><div class="ttdoc">number of filters</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00055">conv_layer.hpp:55</a></div></div>
<div class="ttc" id="classConv__Layer_html_a89b83cf9926dd0779c5ebbca93755820"><div class="ttname"><a href="classConv__Layer.html#a89b83cf9926dd0779c5ebbca93755820">Conv_Layer::depth</a></div><div class="ttdeci">int depth</div><div class="ttdoc">depth of the input</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00052">conv_layer.hpp:52</a></div></div>
<div class="ttc" id="classConv__Layer_html_a1701b3320641cd2514509032da75c024"><div class="ttname"><a href="classConv__Layer.html#a1701b3320641cd2514509032da75c024">Conv_Layer::filter_size</a></div><div class="ttdeci">int filter_size</div><div class="ttdoc">height and width of the square filter</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00053">conv_layer.hpp:53</a></div></div>
<div class="ttc" id="classConv__Layer_html_aaae2d2d7e2197812d9670877a2a85aeb"><div class="ttname"><a href="classConv__Layer.html#aaae2d2d7e2197812d9670877a2a85aeb">Conv_Layer::filters</a></div><div class="ttdeci">vector&lt; vector&lt; MatrixXd &gt; &gt; filters</div><div class="ttdoc">filters of the layer</div><div class="ttdef"><b>Definition:</b> <a href="conv__layer_8hpp_source.html#l00060">conv_layer.hpp:60</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a7b147b25daaba5dff457157a0856d094"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b147b25daaba5dff457157a0856d094">&#9670;&nbsp;</a></span>accumulated_gradient_filters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;MatrixXd&gt; &gt; Conv_Layer::accumulated_gradient_filters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>accumulated gradients of the filters </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00063">63</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a89b83cf9926dd0779c5ebbca93755820"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89b83cf9926dd0779c5ebbca93755820">&#9670;&nbsp;</a></span>depth</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::depth</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>depth of the input </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00052">52</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a1701b3320641cd2514509032da75c024"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1701b3320641cd2514509032da75c024">&#9670;&nbsp;</a></span>filter_size</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::filter_size = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>height and width of the square filter </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00053">53</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="aaae2d2d7e2197812d9670877a2a85aeb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaae2d2d7e2197812d9670877a2a85aeb">&#9670;&nbsp;</a></span>filters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;MatrixXd&gt; &gt; Conv_Layer::filters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>filters of the layer </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00060">60</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a22036e23bad935dbbd9ea32bae3b8a6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22036e23bad935dbbd9ea32bae3b8a6c">&#9670;&nbsp;</a></span>gradient_filters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;vector&lt;MatrixXd&gt; &gt; Conv_Layer::gradient_filters</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gradients of the filters </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00061">61</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a2a0080d32bf49e3cfe0fa01f3010c106"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a0080d32bf49e3cfe0fa01f3010c106">&#9670;&nbsp;</a></span>gradients</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;MatrixXd&gt; Conv_Layer::gradients</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>gradients of the layer </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00059">59</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a8fa49a2055afbb56bd2b1e456e8a217f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fa49a2055afbb56bd2b1e456e8a217f">&#9670;&nbsp;</a></span>height</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::height</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>height of the input </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00050">50</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a0c1e8b24b977813e39633e73588cc90e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c1e8b24b977813e39633e73588cc90e">&#9670;&nbsp;</a></span>input</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;MatrixXd&gt; Conv_Layer::input</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>input of the layer </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00057">57</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a3337c86c1aba37a9c3d9158d6af5e915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3337c86c1aba37a9c3d9158d6af5e915">&#9670;&nbsp;</a></span>num_filters</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::num_filters = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>number of filters </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00055">55</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a8d87494c9f1c7baff061591899be968a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d87494c9f1c7baff061591899be968a">&#9670;&nbsp;</a></span>output</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;MatrixXd&gt; Conv_Layer::output</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>output of the layer </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00058">58</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a7cd15d6b15a9a4b9e0aabdcadf5ad68c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cd15d6b15a9a4b9e0aabdcadf5ad68c">&#9670;&nbsp;</a></span>stride</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::stride = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stride of the filter </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00054">54</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<a id="a5a258888ab5dd029b67af9beca192fcb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a258888ab5dd029b67af9beca192fcb">&#9670;&nbsp;</a></span>width</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int Conv_Layer::width</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>width of the input </p>

<p class="definition">Definition at line <a class="el" href="conv__layer_8hpp_source.html#l00051">51</a> of file <a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>/home/mustafa/DLCPP/libdl/layers/<a class="el" href="conv__layer_8hpp_source.html">conv_layer.hpp</a></li>
<li>/home/mustafa/DLCPP/libdl/layers/<a class="el" href="conv__layer_8cpp_source.html">conv_layer.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.15
</small></address>
</body>
</html>
